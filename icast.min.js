!function(e){"use strict";e(".icast").append('<div class="player-wpr"><div class="blur"></div><div class="player-ctr"><div class="listeners fa"></div><div class="album-cover-wpr"><div class="social-share-wpr animated"> Compartir<br> <a href="" target="_blank" class="social-link social-link-facebook fa animated" id="aface"></a> <a href="" target="_blank" class="social-link social-link-twitter fa animated" id="atwitter"></a></div><div class="album-cover animated"></div></div><div class="track-info-wpr"><div class="track-info-ctr"><div class="marquee"> <span class="artist-name animated">RumbaMix</span><span> - </span><span class="songtitle animated">San Agustin Huila</span></div></div></div><div class="ppBtn play-btn"></div><div class="servertitle"></div></div><div class="icons-left-wpr"><div class="icons-left icons-history fa"></div></div><div class="icons-right-wpr"><div class="icons-right icons-volume fa"></div><div class="icons-right icons-volumeM fa"></div></div> <input class="volume-slider" type="range" min="0" max="100" step="0.10" value="" autocomplete="off"><div class="history-wpr nodisplay"><div class="history-title">Last Played Songs</div></div></div>'),e.fn.icast=function(t){var s,i,a=e.extend({URL:"",version:"2",stream_id:1,mount_point:"",type:"/;type=mp3",streampath:"/stream?icy=http",enable_cors:!1,cors:"https://corsproxy.radioproxy.com",artwork:!0,logo:"img/logo.jpg",servertitle:"My Station",show_listeners:!0,src:"",volume:.75,autoplay:!1},t),o=e(".ppBtn",s=this),r=e(".volume-slider",s),n=e(".icons-volume",s),l=e(".icons-volumeM",s);function c(t,s){e(t).toggleClass("playing",s)}(i=new Audio).volume=a.volume,i.preload="auto",e(".album-cover",s).css({"background-image":"url("+a.logo+")","background-size":"100% 100%"}),e(".blur",s).css({background:"url("+a.logo+")","background-size":"100% 100%"}),s.each(function(){if(1==a.autoplay&&(i.autoplay=!0),0==a.show_listeners&&e(".listeners",s).addClass("nodisplay"),1==a.version)i.src=a.URL+"/;type=mp3",a.src=i.src,f(t=a.cors+"?q="+a.URL+"/7.html",o=a.cors+"?q="+a.URL+"/played.html");else if(2==a.version){if(i.src=a.URL+a.streampath,a.src=i.src,1==a.enable_cors)var t=a.cors+"?q="+a.URL+"/stats?sid="+a.stream_id+"&json=1&callback=?",o=a.cors+"?q="+a.URL+"/played?sid="+a.stream_id+"&type=json&callback=?";else t=a.URL+"/stats?sid="+a.stream_id+"&json=1&callback=?",o=a.URL+"/played?sid="+a.stream_id+"&type=json&callback=?";f(t,o)}else if("icecast"==a.version){if(i.src=a.URL+"/"+a.mount_point,a.src=i.src,1==a.enable_cors)t=a.cors+"?q="+a.URL+"/status-json.xsl";else t=a.URL+"/status-json.xsl";!function(t){if("icecast"==a.version){function i(){e.ajax({dataType:"json",url:t,success:function(t){var i=function(e){if(void 0===e.icestats.source.length)return e.icestats.source;for(var t=0;t<e.icestats.source.length;t++){var s=e.icestats.source[t].listenurl;if(s.indexOf(a.mount_point)>=0)return e.icestats.source[t]}}(t);if(i.title!=g()){y(i.title);var o=i.yp_currently_playing||i.title,r=o.split("-"),n=r[0]||"Undefined",l=r[1]||"Undefined";h(n),w(l),1==a.artwork&&b(n,l),function(t){e(".servertitle",s).text(t.server_name),e(".listeners",s).text(t.listeners)}(i),x(n,l),U(i),function(t){var i=window.location.href,a="https://twitter.com/intent/tweet?text=I'm listening to "+t.title+" @ "+i;e("#atwitter",s).attr("href",a)}(i)}},error:function(){console.log("error getting metadata")}})}i(),setInterval(i,12e3)}}(t)}}),e(i).on("playing",function(){c(o,!0),e(o).addClass("stop-btn"),e(o).removeClass("play-btn")}),e(i).on("pause",function(){c(o,!1),e(o).removeClass("stop-btn"),e(o).addClass("play-btn")}),e(o,s).on("click tap",function(){!function(){if(i.paused){i.src=a.src,i.play();var t=e(".ppBtn.playing");0===e(s).find(t).length&&t.click()}else i.pause()}()});var d=100*i.volume;function u(){e(r).val()<55&&e(r).val()>0&&(e(n).removeClass("icons-volume3 icons-volume1"),e(n).addClass("icons-volume2")),0==e(r).val()?(e(n).removeClass("icons-volume2 icons-volume3"),e(n).addClass("icons-volume1")):e(r).val()>55&&(e(n).removeClass("icons-volume1 icons-volume2"),e(n).addClass("icons-volume3"))}function v(t){return t=t.toLowerCase(),(t=e.trim(t)).includes("&")?t=t.substr(0,t.indexOf(" &")):t.includes("feat")?t=t.substr(0,t.indexOf(" feat")):t.includes("ft.")&&(t=t.substr(0,t.indexOf(" ft."))),t}function p(t){return t=t.toLowerCase(),(t=e.trim(t)).includes("&")?t=t.replace("&","and"):t.includes("(")?t=t.substr(0,t.indexOf(" (")):t.includes("ft")&&(t=t.substr(0,t.indexOf(" ft"))),t}function f(t,i){if(1==a.version){function o(){e.ajax({type:"GET",dataType:"html",url:t,success:function(t){var i=e.parseHTML(t)[1].data,o=i.split(",")[6];if(o!=g()){y(o);var r=o.split("-"),n=r[0]||"Undefined",l=r[1]||"Undefined";h(n),w(l),k(i),1==a.artwork&&b(n,l),x(n,l),U(i),function(t){var i=window.location.href,a="https://twitter.com/intent/tweet?text=I'm listening to "+t.split(",")[6]+" @ "+i;e("#atwitter",s).attr("href",a)}(i)}},error:function(){console.log("error getting metadata")}})}o(),setInterval(o,12e3)}else if(2==a.version){function o(){e.ajax({dataType:"jsonp",url:t,success:function(t){if(t.songtitle!=g()){y(t.songtitle);var o=t.songtitle.split("-"),r=o[0]||"Undefined",n=o[1]||"Undefined";t.servertitle;h(r),w(n),k(t),l=i,e(".history ul li",s).remove(),1==a.version||2==a.version&&(e(".row-wpr",s).remove(),e.ajax({dataType:"jsonp",url:l,success:function(t){t.length=6;for(var i=1;i<t.length;i++){var o=i,r=o,n=t[i].title,l=n.split("-"),c=l[0],d=l[1];e(".history-wpr",s).append("<div class='row-wpr'><div class='history-cover' id='row"+o+"'></div><div class='history-track-info'><div class='history-songtitle'>"+d+"</div><div class='history-artist-name'>"+c+"</div></div><div class='rowNum'>"+r+"</div></div>"),1==a.artwork?C(c,d,o):e("#row"+i,s).css({"background-image":"url("+a.logo+")","background-size":"100% 100%"})}}})),1==a.artwork&&b(r,n),U(t),function(t){var i=window.location.href,a="https://twitter.com/intent/tweet?text=I'm listening to "+t.songtitle+" @ "+i;e("#atwitter",s).attr("href",a)}(t)}var l},error:function(){console.log("error getting metadata")}})}o(),setInterval(o,12e3)}}e(r).val(d),e(".volValueTxt",s).text(d+"%"),u(),e(l).on("click tap",function(){e(l).toggleClass("icons-volumeM2"),e(l).hasClass("icons-volumeM2")?i.volume=0:i.volume=a.volume}),e(".icons-volume",s).on("click",function(){e(r).toggleClass("visible")}),e(r).mouseup(function(){e(this).removeClass("visible")}),"Microsoft Internet Explorer"==navigator.appName||navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/rv:11/)||void 0!==e.browser&&1==e.browser.msie?r.change("input",function(){i.volume=parseInt(this.value,10)/100;var t=100*i.volume;t=Math.round(t);e(".vol-value",s).text("Volume:"+t+"%"),u()},!1):r.on("input",function(){var t=e(r).val();i.volume=t/100;t=Math.round(t);e(".volValueTxt",s).text(t+"%"),u()});var m=new Array;function g(){return e(s).attr("data-tag")}function h(t){e(".artist-name",s).text(t)}function w(t){e(".songtitle",s).text(t)}function y(t){e(s).attr("data-tag",t)}function b(t,i){t=v(t),i=p(i);var o="https://itunes.apple.com/search?term=="+(t=encodeURI(t))+"-"+(i=encodeURI(i))+"&media=music&limit=1";e.ajax({dataType:"jsonp",url:o,success:function(t){if(1==t.results.length)i=(i=t.results[0].artworkUrl100).replace("100x100","400x400");else var i=a.logo;e(".album-cover",s).css({"background-image":"url("+i+")","background-size":"100% 100%"}),e(".album-cover",s).addClass("bounceInDown"),setTimeout(function(){e(".album-cover",s).removeClass("bounceInDown")},5e3),e(".blur",s).css({background:"url("+i+")","background-size":"100% 100%"})},error:function(){console.log("Error on track title "+encodeURI(i))}})}function k(t){1==a.version?(e(".servertitle",s).text(a.servertitle),e(".listeners",s).text(t.split(",")[0])):2==a.version&&(e(".servertitle",s).text(t.servertitle),e(".listeners",s).text(t.currentlisteners))}function x(t,i){!function(e,t){m.unshift({ar:e,tt:t}),m.length=m.length<6?m.length:6}(t,i),function(){e(".row-wpr",s).remove();for(var t=1;t<m.length;t++){var i=t,o=i,r=m[t].ar,n=m[t].tt;e(".history-wpr",s).append("<div class='row-wpr'><div class='history-cover' id='row"+i+"'></div><div class='history-track-info'><div class='history-songtitle'>"+n+"</div><div class='history-artist-name'>"+r+"</div></div><div class='rowNum'>"+o+"</div></div>"),1==a.artwork?C(r,n,i):e("#row"+t,s).css({"background-image":"url("+a.logo+")","background-size":"100% 100%"})}}()}function C(t,i,o){t=v(t),i=p(i),t=encodeURI(t),i=encodeURI(i);var r="https://itunes.apple.com/search?term=="+t+"-"+i+"&media=music&limit=1";e.ajax({dataType:"jsonp",url:r,success:function(t){if(1==t.results.length)i=(i=t.results[0].artworkUrl100).replace("100x100","400x400");else var i=a.logo;e("#row"+o,s).css({"background-image":"url("+i+")","background-size":"100% 100%"})},error:function(){console.log("#getImageList(), Error in loading history image list for "+decodeURI(t))}})}function U(t){var i=window.location.href,a="https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(i);e("#aface",s).attr("href",a)}e(".icons-history",s).on("click tap",function(){e(".icons-history",s).toggleClass("icons-close"),e(".player-ctr",s).hasClass("open")?e(".player-ctr",s).hasClass("open")&&(e(".player-ctr",s).removeClass("open"),e(".history-wpr",s).fadeOut(400),e(".player-ctr",s).delay(600).fadeIn(400)):(e(".player-ctr",s).fadeOut(400),e(".history-wpr",s).delay(600).fadeIn(400),e(".player-ctr",s).addClass("open"))}),e(".album-cover-wpr",s).hover(function(){e(".social-share-wpr",s).toggleClass("display"),e(".social-link-twitter",s).toggleClass("bounceIn"),e(".social-link-facebook",s).toggleClass("bounceIn")}),/Android|webOS|iPhone|iPad|iPod|Opera Mini/i.test(navigator.userAgent)&&(e(n).addClass("nodisplay"),e(l).addClass("display"))}}(jQuery);